import{t as v}from"./index.Br1Li-Ke.js";/* empty css                       */import{_ as R}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{g as _,e as l,j as S,t as f,F as B,h as A,r as h,f as F,o as u,n as J,b as I}from"./runtime-core.esm-bundler.BLIdz6c-.js";const V={__name:"StreakCard",setup(T,{expose:p}){p();const d=h(0),t=h([]),y=h(!1);F(()=>{o()});const b=e=>{try{const a=JSON.parse(localStorage.getItem("storiesData"))||[],n=JSON.parse(localStorage.getItem("songsData"))||[],r=[...a,...n];let i=0;return r.forEach(m=>{if(m.completedAt&&m.finished){const s=new Date(m.completedAt);s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0")===e&&i++}}),i}catch(a){return console.error("Error getting completed count:",a),0}},o=()=>{const e=[],a=new Date;for(let n=6;n>=0;n--){const r=new Date(a);r.setDate(r.getDate()-n);const i=r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0"),m=r.toLocaleDateString("en-US",{weekday:"short"}),s=b(i);e.push({date:i,label:n===0?"Today":m,count:s,isToday:n===0})}t.value=e,y.value=e[6].count>0,c()},c=()=>{try{const e=JSON.parse(localStorage.getItem("storiesData"))||[],a=JSON.parse(localStorage.getItem("songsData"))||[],n=[...e,...a],r={};n.forEach(k=>{if(k.completedAt&&k.finished){const D=new Date(k.completedAt),w=D.getFullYear()+"-"+String(D.getMonth()+1).padStart(2,"0")+"-"+String(D.getDate()).padStart(2,"0");r[w]||(r[w]=0),r[w]++}});let i=0;const m=new Date;let s=new Date(m);for(s.setDate(s.getDate()-1);;){const k=s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0");if(r[k])i++,s.setDate(s.getDate()-1);else break}i>0&&(i+=1),d.value=i}catch(e){console.error("Error updating current streak:",e),d.value=0}},C=["/assets/streak/stickers/s1.webp","/assets/streak/stickers/s2.webp","/assets/streak/stickers/s3.webp","/assets/streak/stickers/s4.webp","/assets/streak/stickers/s5.webp","/assets/streak/stickers/s6.webp","/assets/streak/stickers/s7.webp","/assets/streak/stickers/s8.webp"],g=[{min:0,max:0,image:"/assets/streak/characters/tiny-flame.webp",name:"Tiny Flame"},{min:1,max:1,image:"/assets/streak/characters/tiny-flame.webp",name:"Tiny Flame"},{min:2,max:4,image:"/assets/streak/characters/ember-starter.webp",name:"Ember Starter"},{min:5,max:9,image:"/assets/streak/characters/spark-igniter.webp",name:"Spark Igniter"},{min:10,max:19,image:"/assets/streak/characters/flame-warrior.webp",name:"Flame Warrior"},{min:20,max:39,image:"/assets/streak/characters/blazing-master.webp",name:"Blazing Master"},{min:40,max:59,image:"/assets/streak/characters/inferno-champion.webp",name:"Inferno Champion"},{min:60,max:79,image:"/assets/streak/characters/eternal-flame.webp",name:"Eternal Flame"},{min:80,max:1/0,image:"/assets/streak/characters/cosmic-inferno.webp",name:"Cosmic Inferno"}];function x(e){return C[e%8]}function N(){const e=g.find(a=>d.value>=a.min&&d.value<=a.max);return e?e.image:g[0].image}function L(){const e=g.find(a=>d.value>=a.min&&d.value<=a.max);return e?e.name:g[0].name}function O(e){const a=Math.sin(e*12.9898+78.233)*43758.5453;return(a-Math.floor(a))*45-22.5}function z(e){const a=Math.sin(e*34.233+45.164)*34748.2384;return(a-Math.floor(a))*20-10}function E(e){if(e.isToday)return v("streak.today");const n={Mon:"streak.mon",Tue:"streak.tue",Wed:"streak.wed",Thu:"streak.thu",Fri:"streak.fri",Sat:"streak.sat",Sun:"streak.sun"}[e.label];return n?v(n):e.label}const M={currentStreak:d,last7Days:t,hasStreakToday:y,getCompletedCountForDate:b,calculateLast7Days:o,updateCurrentStreak:c,starStickers:C,characterLevels:g,getSticker:x,getCharacterImage:N,getCharacterName:L,getRandomRotation:O,getRandomOffset:z,getLocalizedDayLabel:E,onMounted:F,ref:h,get t(){return v}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}},Y={class:"streak-card__header"},W={class:"streak-card__character"},j=["src","alt"],K={class:"streak-card__label"},P={class:"streak-card__days"},U=["src","alt"],q={key:0,class:"streak-card__day-number"},G={class:"streak-card__day-label"};function H(T,p,d,t,y,b){return u(),_("div",{class:S(["streak-card",{"streak-card--milestone-25":t.currentStreak%25===0&&t.currentStreak>0,"streak-card--milestone-50":t.currentStreak%50===0&&t.currentStreak>0}])},[p[0]||(p[0]=l("div",{class:"streak-card__top-spacing"},null,-1)),l("div",Y,[l("div",W,[l("img",{src:t.getCharacterImage(),alt:t.getCharacterName(),class:"streak-card__character-img"},null,8,j)]),l("div",{class:S(["streak-card__number",{"streak-card__number--pulse-intense":t.currentStreak%25===0&&t.currentStreak>0,"streak-card__number--frozen":!t.hasStreakToday&&t.currentStreak>0,"streak-card__number--burning":t.hasStreakToday}])},f(t.currentStreak),3),l("div",K,f(t.t("streak.label")),1)]),l("div",P,[(u(!0),_(B,null,A(t.last7Days,(o,c)=>(u(),_("div",{key:c,class:S(["streak-card__day-wrapper",{"streak-card__day-wrapper--second-row":c>=4}]),style:J({"--delay":`${c*.15}s`,"--rotation":`${t.getRandomRotation(c)}deg`,"--offset":`${t.getRandomOffset(c)}px`})},[o.count>0?(u(),_("img",{key:0,src:t.getSticker(c),alt:`sticker-${c}`,class:"streak-card__sticker streak-card__day-img--drop"},null,8,U)):I("",!0),l("div",{class:S(["streak-card__day-dot",{"streak-card__day-dot--empty":o.count===0,"streak-card__day-dot--one":o.count===1,"streak-card__day-dot--epic":o.count>1,"streak-card__day-dot--today":o.isToday}])},[o.count>1?(u(),_("span",q,f(o.count),1)):I("",!0)],2),l("div",G,f(t.getLocalizedDayLabel(o)),1)],6))),128))])],2)}const ee=R(V,[["render",H],["__scopeId","data-v-abb82969"]]);export{ee as default};
