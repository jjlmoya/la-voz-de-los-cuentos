import{t as w}from"./index.Br1Li-Ke.js";/* empty css                       */import{_ as R}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{g as _,e as i,j as v,t as S,F as B,h as A,r as f,f as F,o as u,n as J,b as x}from"./runtime-core.esm-bundler.BLIdz6c-.js";const V={__name:"StreakCard",setup(I,{expose:p}){p();const l=f(0),t=f([]),h=f(!1);F(()=>{n()});const y=e=>{try{const a=JSON.parse(localStorage.getItem("storiesData"))||[],s=JSON.parse(localStorage.getItem("songsData"))||[],r=[...a,...s];let d=0;return r.forEach(m=>{if(m.completedAt&&m.finished){const o=new Date(m.completedAt);o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0")+"-"+String(o.getDate()).padStart(2,"0")===e&&d++}}),d}catch(a){return console.error("Error getting completed count:",a),0}},n=()=>{const e=[],a=new Date;for(let s=6;s>=0;s--){const r=new Date(a);r.setDate(r.getDate()-s);const d=r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0"),m=r.toLocaleDateString("en-US",{weekday:"short"}),o=y(d);e.push({date:d,label:s===0?"Today":m,count:o,isToday:s===0})}t.value=e,h.value=e[6].count>0,c()},c=()=>{try{const e=JSON.parse(localStorage.getItem("storiesData"))||[],a=JSON.parse(localStorage.getItem("songsData"))||[],s=[...e,...a],r={};s.forEach(k=>{if(k.completedAt&&k.finished){const b=new Date(k.completedAt),D=b.getFullYear()+"-"+String(b.getMonth()+1).padStart(2,"0")+"-"+String(b.getDate()).padStart(2,"0");r[D]||(r[D]=0),r[D]++}});let d=0;const m=new Date;let o=new Date(m);for(;;){const k=o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0")+"-"+String(o.getDate()).padStart(2,"0");if(r[k])d++,o.setDate(o.getDate()-1);else break}l.value=d}catch(e){console.error("Error updating current streak:",e),l.value=0}},C=["/assets/streak/stickers/s1.webp","/assets/streak/stickers/s2.webp","/assets/streak/stickers/s3.webp","/assets/streak/stickers/s4.webp","/assets/streak/stickers/s5.webp","/assets/streak/stickers/s6.webp","/assets/streak/stickers/s7.webp","/assets/streak/stickers/s8.webp"],g=[{min:0,max:0,image:"/assets/streak/characters/tiny-flame.webp",name:"Tiny Flame"},{min:1,max:1,image:"/assets/streak/characters/tiny-flame.webp",name:"Tiny Flame"},{min:2,max:4,image:"/assets/streak/characters/ember-starter.webp",name:"Ember Starter"},{min:5,max:9,image:"/assets/streak/characters/spark-igniter.webp",name:"Spark Igniter"},{min:10,max:19,image:"/assets/streak/characters/flame-warrior.webp",name:"Flame Warrior"},{min:20,max:39,image:"/assets/streak/characters/blazing-master.webp",name:"Blazing Master"},{min:40,max:59,image:"/assets/streak/characters/inferno-champion.webp",name:"Inferno Champion"},{min:60,max:79,image:"/assets/streak/characters/eternal-flame.webp",name:"Eternal Flame"},{min:80,max:1/0,image:"/assets/streak/characters/cosmic-inferno.webp",name:"Cosmic Inferno"}];function T(e){return C[e%8]}function N(){const e=g.find(a=>l.value>=a.min&&l.value<=a.max);return e?e.image:g[0].image}function L(){const e=g.find(a=>l.value>=a.min&&l.value<=a.max);return e?e.name:g[0].name}function O(e){const a=Math.sin(e*12.9898+78.233)*43758.5453;return(a-Math.floor(a))*45-22.5}function z(e){const a=Math.sin(e*34.233+45.164)*34748.2384;return(a-Math.floor(a))*20-10}function E(e){if(e.isToday)return w("streak.today");const s={Mon:"streak.mon",Tue:"streak.tue",Wed:"streak.wed",Thu:"streak.thu",Fri:"streak.fri",Sat:"streak.sat",Sun:"streak.sun"}[e.label];return s?w(s):e.label}const M={currentStreak:l,last7Days:t,hasStreakToday:h,getCompletedCountForDate:y,calculateLast7Days:n,updateCurrentStreak:c,starStickers:C,characterLevels:g,getSticker:T,getCharacterImage:N,getCharacterName:L,getRandomRotation:O,getRandomOffset:z,getLocalizedDayLabel:E,onMounted:F,ref:f,get t(){return w}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}},Y={class:"streak-card__header"},W={class:"streak-card__character"},j=["src","alt"],K={class:"streak-card__label"},P={class:"streak-card__days"},U=["src","alt"],q={key:0,class:"streak-card__day-number"},G={class:"streak-card__day-label"};function H(I,p,l,t,h,y){return u(),_("div",{class:v(["streak-card",{"streak-card--milestone-25":t.currentStreak%25===0&&t.currentStreak>0,"streak-card--milestone-50":t.currentStreak%50===0&&t.currentStreak>0}])},[p[0]||(p[0]=i("div",{class:"streak-card__top-spacing"},null,-1)),i("div",Y,[i("div",W,[i("img",{src:t.getCharacterImage(),alt:t.getCharacterName(),class:"streak-card__character-img"},null,8,j)]),i("div",{class:v(["streak-card__number",{"streak-card__number--pulse-intense":t.currentStreak%25===0&&t.currentStreak>0,"streak-card__number--frozen":!t.hasStreakToday&&t.currentStreak>0,"streak-card__number--burning":t.hasStreakToday}])},S(t.currentStreak),3),i("div",K,S(t.t("streak.label")),1)]),i("div",P,[(u(!0),_(B,null,A(t.last7Days,(n,c)=>(u(),_("div",{key:c,class:"streak-card__day-wrapper",style:J({"--delay":`${c*.15}s`,"--rotation":`${t.getRandomRotation(c)}deg`,"--offset":`${t.getRandomOffset(c)}px`})},[n.count>0?(u(),_("img",{key:0,src:t.getSticker(c),alt:`sticker-${c}`,class:"streak-card__sticker streak-card__day-img--drop"},null,8,U)):x("",!0),i("div",{class:v(["streak-card__day-dot",{"streak-card__day-dot--empty":n.count===0,"streak-card__day-dot--one":n.count===1,"streak-card__day-dot--epic":n.count>1,"streak-card__day-dot--today":n.isToday}])},[n.count>1?(u(),_("span",q,S(n.count),1)):x("",!0)],2),i("div",G,S(t.getLocalizedDayLabel(n)),1)],4))),128))])],2)}const ee=R(V,[["render",H],["__scopeId","data-v-5ae5847a"]]);export{ee as default};
