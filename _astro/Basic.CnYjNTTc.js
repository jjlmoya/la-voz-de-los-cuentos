import{b as w}from"./index.DIhC7bAX.js";import{_ as O,I as R}from"./_plugin-vue_export-helper.DrVY87Ov.js";import{b as j}from"./index.BAeavcBF.js";import{g as l,j as p,l as C,h as D,q as B,o as v,c as h,e as c,d as k,a as E,w as I,f as T,t as x,b as N,n as J}from"./runtime-dom.esm-bundler.5IqPX93W.js";/* empty css                      */const L=j();function V(a){const o=l([]),s=l({}),t=()=>a.story.split(`
`).filter(e=>e.trim()!=="")[0],d=()=>a.story.split(`
`).filter(e=>e.trim()!=="").map((e,r)=>`<p key=${r}>${e}</p>`).join("<br>"),u=()=>`${Math.ceil(parseInt(a.time)/60)} min`,y=()=>{if(a.saga)return L.find(e=>e.key===a.saga)?.name},g=()=>{o.value=JSON.parse(localStorage.getItem("storiesData"))||[],s.value=p(o).find(e=>e.key===a.key)},n=()=>{try{g();const e=p(s),r=Math.ceil(e.spentTime/parseInt(e.totalTime)*100),S=r>100?100:r;return{...e,current:S}}catch{return{}}},m=()=>n().current>=100,f=e=>{const r=s.value;r.like=e,s.value=r,_()},_=()=>{const e=JSON.parse(localStorage.getItem("storiesData"))||[],r=p(o).findIndex(S=>S.key===a.key);r===-1&&e.push({key:a.key,spentTime:0,totalTime:a.time,finished:!1,like:!1}),e[r]=p(s),localStorage.setItem("storiesData",JSON.stringify(e))},i=()=>{let e=s.value;e.spentTime+=10,e.spentTime>=parseInt(e.totalTime)&&(e.finished=!0),s.value=e,_()};return{firstParagraph:t,getTime:u,html:d,getSaga:y,getCurrentStatus:n,setLikeStatus:f,isComplete:m,reading:()=>{g(),_(),setInterval(i,1e4)}}}const M={__name:"Basic",props:{title:{type:String,default:""},slug:{type:String,default:""},time:{type:Number,default:0},isStory:{type:Boolean,default:!0},isCharacter:{type:Boolean,default:!1},as:{type:String,default:"div"},progress:{type:Number,default:0}},setup(a,{expose:o}){o();const s="es",t=a,{getTime:d,getCurrentStatus:u}=V({key:t.slug,time:t.time}),y=()=>t.isStory?`/assets/stories/${s}/${t.slug}.webp`:t.isCharacter?`/assets/characters/${t.slug}.webp`:`/assets/sagas/${s}/${t.slug}.webp`,g=d(),n=l(null),m=l({}),f=l(!1),_=C(()=>(m.value.current||t.progress)>=100);let i;D(()=>{i=new IntersectionObserver(([e])=>{e.isIntersecting&&(f.value=!0,i.unobserve(n.value))},{threshold:.1}),n.value&&i.observe(n.value),m.value=t.progress||u()}),B(()=>{i&&n.value&&i.unobserve(n.value)});const b={lang:s,props:t,getTime:d,getCurrentStatus:u,getImage:y,renderedTime:g,cardRef:n,status:m,isIntersecting:f,isCompleted:_,get observer(){return i},set observer(e){i=e},get toStory(){return w},ref:l,onMounted:D,onUnmounted:B,computed:C,get VText(){return R},get useStory(){return V}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},P=["href"],z={class:"basic-card__image-wrapper"},q={class:"basic-card__image"},A=["alt","src"],U={key:1,class:"basic-card__completed"},F={class:"basic-card__progress"},G={class:"basic-card__content"},H={class:"basic-card__article"};function K(a,o,s,t,d,u){return v(),h("a",{ref:"cardRef",class:"basic-card",href:t.toStory(s.slug)},[c("div",z,[c("div",q,[t.isIntersecting?(v(),h("img",{key:0,alt:`Imagen de ${s.title}`,class:"basic-card__img",aspectRatio:1/1,src:t.getImage(),loading:"lazy"},null,8,A)):k("",!0),o[0]||(o[0]=c("div",{class:"basic-card__image-overlay"},null,-1))]),s.time?(v(),E(t.VText,{key:0,class:"basic-card__time"},{default:I(()=>[T(x(t.renderedTime),1)]),_:1})):k("",!0),t.isCompleted?(v(),h("div",U,[N(t.VText,{class:"basic-card__completed-text"},{default:I(()=>[T(x(t.lang==="es"?"¡LEÍDO!":"READ!"),1)]),_:1})])):k("",!0),c("div",F,[c("div",{style:J({width:`${t.status.current||s.progress}%`}),class:"basic-card__progress-complete"},null,4)])]),c("div",G,[c("div",H,[N(t.VText,{class:"basic-card__title",variant:"header",color:"primary",maxLines:"2",as:s.as},{default:I(()=>[T(x(s.title),1)]),_:1},8,["as"])])])],8,P)}const $=O(M,[["render",K],["__scopeId","data-v-eae8d924"]]);export{$ as B,V as u};
