import{a as T}from"./index.C0UmanwU.js";import{r as m,q as n}from"./runtime-core.esm-bundler.OheDorFq.js";const h=T();function D(a){const r=m([]),s=m({}),u=()=>a.story.split(`
`).filter(t=>t.trim()!=="")[0],p=()=>a.story.split(`
`).filter(t=>t.trim()!=="").map((t,e)=>`<p key=${e}>${t}</p>`).join("<br>"),g=()=>`${Math.ceil(parseInt(a.time)/60)} min`,f=()=>{if(a.saga)return h.find(t=>t.key===a.saga)?.name},c=()=>{r.value=JSON.parse(localStorage.getItem("storiesData"))||[],s.value=n(r).find(t=>t.key===a.key)},l=()=>{try{c();const t=n(s),e=Math.ceil(t.spentTime/parseInt(t.totalTime)*100),o=e>100?100:e;return{...t,current:o}}catch{return{}}},S=()=>l().current>=100,d=t=>{const e=s.value;e.like=t,s.value=e,i()},i=()=>{const t=JSON.parse(localStorage.getItem("storiesData"))||[],e=n(r).findIndex(o=>o.key===a.key);e===-1&&t.push({key:a.key,spentTime:0,totalTime:a.time,finished:!1,like:!1}),t[e]=n(s),localStorage.setItem("storiesData",JSON.stringify(t))},k=()=>{let t=s.value;t.spentTime+=10,t.spentTime>=parseInt(t.totalTime)&&(t.finished=!0),s.value=t,i()};return{firstParagraph:u,getTime:g,html:p,getSaga:f,getCurrentStatus:l,setLikeStatus:d,isComplete:S,reading:()=>{c(),i(),setInterval(k,1e4)}}}export{D as u};
