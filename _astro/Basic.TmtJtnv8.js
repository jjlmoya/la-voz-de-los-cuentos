import{b as D}from"./index._j4IZrpC.js";import{_ as V,I as w}from"./_plugin-vue_export-helper.CCebKmzk.js";import{b as O}from"./index.DLxjx8PA.js";import{g as c,j as v,h,q as k,o as b,c as I,e as d,b as T,n as j,d as J,w as x,f as B,t as C,a as M}from"./runtime-dom.esm-bundler.D02XeAb0.js";/* empty css                      */const P=O();function N(a){const o=c([]),s=c({}),t=()=>a.story.split(`
`).filter(e=>e.trim()!=="")[0],l=()=>a.story.split(`
`).filter(e=>e.trim()!=="").map((e,n)=>`<p key=${n}>${e}</p>`).join("<br>"),u=()=>`${Math.ceil(parseInt(a.time)/60)} min`,y=()=>{if(a.saga)return P.find(e=>e.key===a.saga)?.name},m=()=>{o.value=JSON.parse(localStorage.getItem("storiesData"))||[],s.value=v(o).find(e=>e.key===a.key)},i=()=>{try{m();const e=v(s),n=Math.ceil(e.spentTime/parseInt(e.totalTime)*100),S=n>100?100:n;return{...e,current:S}}catch{return{}}},g=()=>i().current>=100,_=e=>{const n=s.value;n.like=e,s.value=n,r()},r=()=>{const e=JSON.parse(localStorage.getItem("storiesData"))||[],n=v(o).findIndex(S=>S.key===a.key);n===-1&&e.push({key:a.key,spentTime:0,totalTime:a.time,finished:!1,like:!1}),e[n]=v(s),localStorage.setItem("storiesData",JSON.stringify(e))},f=()=>{let e=s.value;e.spentTime+=10,e.spentTime>=parseInt(e.totalTime)&&(e.finished=!0),s.value=e,r()};return{firstParagraph:t,getTime:u,html:l,getSaga:y,getCurrentStatus:i,setLikeStatus:_,isComplete:g,reading:()=>{m(),r(),setInterval(f,1e4)}}}const R={__name:"Basic",props:{title:{type:String,default:""},slug:{type:String,default:""},time:{type:Number,default:0},isStory:{type:Boolean,default:!0},isCharacter:{type:Boolean,default:!1},as:{type:String,default:"div"},progress:{type:Number,default:0}},setup(a,{expose:o}){o();const s="es",t=a,{getTime:l,getCurrentStatus:u}=N({key:t.slug,time:t.time}),y=()=>t.isStory?`/assets/stories/${s}/${t.slug}.webp`:t.isCharacter?`/assets/characters/${t.slug}.webp`:`/assets/sagas/${s}/${t.slug}.webp`,m=l(),i=c(null),g=c({}),_=c(!1);let r;h(()=>{r=new IntersectionObserver(([p])=>{p.isIntersecting&&(_.value=!0,r.unobserve(i.value))},{threshold:.1}),i.value&&r.observe(i.value),g.value=t.progress||u()}),k(()=>{r&&i.value&&r.unobserve(i.value)});const f={lang:s,props:t,getTime:l,getCurrentStatus:u,getImage:y,renderedTime:m,cardRef:i,status:g,isIntersecting:_,get observer(){return r},set observer(p){r=p},get toStory(){return D},ref:c,onMounted:h,onUnmounted:k,get VText(){return w},get useStory(){return N}};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}},z=["href"],L={class:"basic-card__image"},q=["alt","src"],E={class:"basic-card__progress"},U={class:"basic-card__content"},$={class:"basic-card__article"};function A(a,o,s,t,l,u){return b(),I("a",{ref:"cardRef",class:"basic-card",href:t.toStory(s.slug)},[d("div",L,[t.isIntersecting?(b(),I("img",{key:0,alt:`Imagen de ${s.title}`,class:"basic-card__img",aspectRatio:1/1,src:t.getImage(),loading:"lazy"},null,8,q)):T("",!0),d("div",E,[d("div",{style:j({width:`${t.status.current||s.progress}%`}),class:"basic-card__progress-complete"},null,4)])]),d("div",U,[d("div",$,[J(t.VText,{class:"basic-card__title",variant:"header",color:"primary",maxLines:"2",as:s.as},{default:x(()=>[B(C(s.title),1)]),_:1},8,["as"])])]),s.time?(b(),M(t.VText,{key:0,class:"basic-card__time"},{default:x(()=>[B(C(t.renderedTime),1)]),_:1})):T("",!0)],8,z)}const W=V(R,[["render",A],["__scopeId","data-v-5efa85fd"]]);export{W as B,N as u};
