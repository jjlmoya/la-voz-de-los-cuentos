import{a as O}from"./index.BMPHkLeA.js";import{_ as L,I as R}from"./_plugin-vue_export-helper.DqBN71eW.js";import{c as j}from"./index.DmVuQxNN.js";import{g as d,m as v,c as I,e as c,a as D,d as S,w as b,f as h,t as k,b as V,n as E,j as C,h as B,s as N,o as p}from"./runtime-dom.esm-bundler.BQ86NAFe.js";/* empty css                      */const J=j();function w(r){const i=d([]),s=d({}),t=()=>r.story.split(`
`).filter(e=>e.trim()!=="")[0],u=()=>r.story.split(`
`).filter(e=>e.trim()!=="").map((e,a)=>`<p key=${a}>${e}</p>`).join("<br>"),m=()=>`${Math.ceil(parseInt(r.time)/60)} min`,T=()=>{if(r.saga)return J.find(e=>e.key===r.saga)?.name},f=()=>{i.value=JSON.parse(localStorage.getItem("storiesData"))||[],s.value=v(i).find(e=>e.key===r.key)},n=()=>{try{f();const e=v(s),a=Math.ceil(e.spentTime/parseInt(e.totalTime)*100),l=a>100?100:a;return{...e,current:l}}catch{return{}}},_=()=>n().current>=100,y=e=>{const a=s.value;a.like=e,s.value=a,g()},g=()=>{const e=JSON.parse(localStorage.getItem("storiesData"))||[],a=v(i).findIndex(l=>l.key===r.key);a===-1&&e.push({key:r.key,spentTime:0,totalTime:r.time,finished:!1,like:!1}),e[a]=v(s),localStorage.setItem("storiesData",JSON.stringify(e))},x=()=>{let e=s.value;e.spentTime+=10,e.spentTime>=parseInt(e.totalTime)&&(e.finished=!0),s.value=e,g()};return{firstParagraph:t,getTime:m,html:u,getSaga:T,getCurrentStatus:n,setLikeStatus:y,isComplete:_,reading:()=>{f(),g(),setInterval(x,1e4)}}}const M={__name:"Basic",props:{title:{type:String,default:""},slug:{type:String,default:""},time:{type:Number,default:0},isStory:{type:Boolean,default:!0},isCharacter:{type:Boolean,default:!1},as:{type:String,default:"div"},progress:{type:Number,default:0},storyContent:{type:String,default:""}},setup(r,{expose:i}){i();const s="es",t=r,{getTime:u,getCurrentStatus:m}=w({key:t.slug,time:t.time}),T=()=>t.isStory?`/assets/stories/${s}/${t.slug}.webp`:t.isCharacter?`/assets/characters/${t.slug}.webp`:`/assets/sagas/${s}/${t.slug}.webp`,f=u(),n=d(null),_=d({}),y=d(!1),g=C(()=>(_.value.current||t.progress)>=100),x=C(()=>{if(!t.storyContent||!t.isStory)return"";const a=t.storyContent.replace(/\n+/g," ").trim(),l=120;return a.length>l?a.substring(0,l)+"...":a});let o;B(()=>{o=new IntersectionObserver(([a])=>{a.isIntersecting&&(y.value=!0,o.unobserve(n.value))},{threshold:.1}),n.value&&o.observe(n.value),_.value=t.progress||m()}),N(()=>{o&&n.value&&o.unobserve(n.value)});const e={lang:s,props:t,getTime:u,getCurrentStatus:m,getImage:T,renderedTime:f,cardRef:n,status:_,isIntersecting:y,isCompleted:g,storySnippet:x,get observer(){return o},set observer(a){o=a},get toStory(){return O},ref:d,onMounted:B,onUnmounted:N,computed:C,get VText(){return R},get useStory(){return w}};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}},P=["href"],z={class:"basic-card__image-wrapper"},A={class:"basic-card__image"},U=["alt","src"],q={key:1,class:"basic-card__completed"},F={class:"basic-card__progress"},G={class:"basic-card__content"},H={class:"basic-card__article"};function K(r,i,s,t,u,m){return p(),I("a",{ref:"cardRef",class:"basic-card",href:t.toStory(s.slug)},[c("div",z,[c("div",A,[t.isIntersecting?(p(),I("img",{key:0,alt:`Imagen de ${s.title}`,class:"basic-card__img",aspectRatio:1/1,src:t.getImage(),loading:"lazy"},null,8,U)):S("",!0),i[0]||(i[0]=c("div",{class:"basic-card__image-overlay"},null,-1))]),s.time?(p(),D(t.VText,{key:0,class:"basic-card__time"},{default:b(()=>[h(k(t.renderedTime),1)]),_:1})):S("",!0),t.isCompleted?(p(),I("div",q,[V(t.VText,{class:"basic-card__completed-text"},{default:b(()=>[h(k(t.lang==="es"?"¡LEÍDO!":"READ!"),1)]),_:1})])):S("",!0),c("div",F,[c("div",{style:E({width:`${t.status.current||s.progress}%`}),class:"basic-card__progress-complete"},null,4)])]),c("div",G,[c("div",H,[V(t.VText,{class:"basic-card__title",variant:"header",color:"primary",maxLines:"2",as:s.as},{default:b(()=>[h(k(s.title),1)]),_:1},8,["as"]),t.storySnippet?(p(),D(t.VText,{key:0,class:"basic-card__snippet",variant:"body",color:"medium",maxLines:"3"},{default:b(()=>[h(k(t.storySnippet),1)]),_:1})):S("",!0)])])],8,P)}const $=L(M,[["render",K],["__scopeId","data-v-76b3c100"]]);export{$ as B,w as u};
