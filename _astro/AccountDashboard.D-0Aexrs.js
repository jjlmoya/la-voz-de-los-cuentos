import I from"./AccountSummary.WF19Btsx.js";import V from"./StreakCard.CDU2fdV7.js";import{u as T}from"./useStories.vtCQGMnN.js";import{a as M}from"./index.WD-CXpjI.js";import{b as E}from"./index.brZL-3I0.js";import{t as O}from"./index.Br1Li-Ke.js";import{_ as j}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{g as i,e as t,b,t as a,a as N,F as x,h as A,r as m,f as D,k as z,o as n,n as J}from"./runtime-core.esm-bundler.BLIdz6c-.js";import"./index-FitP4J_6.BPTo_1p2.js";import"./runtime-dom.esm-bundler.BbeENm1T.js";import"./useAchievements.ClmU0UKr.js";import"./achievementEvents.DHKWVqNG.js";/* empty css                       */import"./useStory.CIsWWWiV.js";import"./landings.D6rrVUZj.js";const L={__name:"AccountDashboard",props:{lang:{type:String,default:"es"}},setup(w,{expose:r}){r();const{getAllStories:u}=T(),s=M(),p=l=>{const d=s.find(h=>h.key===l);return d?d.name:l},g=m(0),e=m(0),S=m(0),f=m([]),v=m([]);D(()=>{if(!(typeof localStorage>"u"))try{const l=localStorage.getItem("storiesData");if(!l)return;const d=JSON.parse(l);if(!Array.isArray(d))return;const h=u(),R=d.reduce((o,c)=>o+(c&&c.spentTime||0),0);g.value=Math.round(R/3600);const y=d.filter(o=>o&&o.finished===!0).length;e.value=h.length>0?Math.round(y/h.length*100):0,S.value=y;const C=d.map(o=>{if(!o||!o.key)return null;const c=h.find(F=>F.key===o.key);if(!c)return null;const _=parseFloat(String(o.totalTime).replace(",","."));if(isNaN(_)||_<=0)return null;const B=Math.round(o.spentTime/_*100);return{...c,timeSpent:Math.max(0,Math.round(o.spentTime/60)),totalTime:Math.max(1,Math.ceil(_/60)),progress:Math.min(100,Math.max(0,B))}}).filter(o=>o&&o.progress>0&&o.progress<100).sort((o,c)=>c.timeSpent-o.timeSpent).slice(0,3);f.value=C;const P=h.filter(o=>{const c=d.find(_=>_&&_.key===o.key);return!c||c.finished!==!0});v.value=P.sort(()=>Math.random()-.5).slice(0,3)}catch(l){console.error("Error loading dashboard data:",l)}});const k={getAllStories:u,allSagas:s,getSagaName:p,totalTimeSpent:g,progressPercentage:e,storiesRead:S,recentStories:f,suggestedStories:v,ref:m,onMounted:D,computed:z,AccountSummary:I,StreakCard:V,get useStories(){return T},get getSagas(){return M},get toStory(){return E},get t(){return O}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}},W={class:"account-dashboard"},q={class:"dashboard-header"},G={class:"dashboard-header__content"},H={class:"dashboard-header__title"},Q={class:"dashboard-header__subtitle"},U={class:"dashboard-summary"},X={class:"dashboard-section"},Y={class:"dashboard-section"},Z={class:"dashboard-section__title"},K={class:"stats-grid"},$={class:"stat-card stat-card--time"},tt={class:"stat-card__label"},st={class:"stat-card__value"},at={class:"stat-card stat-card--progress"},et={class:"stat-card__label"},ot={class:"stat-card__value"},rt={class:"stat-card stat-card--books"},ct={class:"stat-card__label"},dt={class:"stat-card__value"},it={key:0,class:"dashboard-section"},nt={class:"dashboard-section__title"},lt={class:"stories-row"},_t=["href"],ht={class:"story-card__progress"},mt={class:"story-card__content"},ut={class:"story-card__title"},gt={class:"story-card__time"},bt={key:1,class:"dashboard-section"},pt={class:"dashboard-section__title"},St={class:"stories-carousel"},ft=["href"],vt={class:"carousel-card__header"},kt={class:"carousel-card__tag"},yt={class:"carousel-card__content"},Tt={class:"carousel-card__title"},Mt={class:"carousel-card__time"},Nt={key:0,class:"carousel-card__saga"},xt={class:"carousel-card__cta"};function At(w,r,u,s,p,g){return n(),i("div",W,[t("div",q,[t("div",G,[t("h1",H,a(s.t("account.dashboard.title")),1),t("p",Q,a(s.t("account.dashboard.subtitle")),1)]),r[0]||(r[0]=t("div",{class:"dashboard-header__decoration"},[t("img",{src:"/assets/account/dashboard-assets/dashboard-decoration.webp",alt:"decoration",class:"dashboard-header__image"})],-1))]),t("div",U,[N(s.AccountSummary,{lang:u.lang},null,8,["lang"])]),t("div",X,[N(s.StreakCard)]),t("div",Y,[t("h2",Z,a(s.t("account.dashboard.statistics")),1),t("div",K,[t("div",$,[r[1]||(r[1]=t("img",{src:"/assets/account/dashboard-assets/stat-time.webp",alt:"time",class:"stat-card__icon"},null,-1)),t("div",tt,a(s.t("account.dashboard.totalTime")),1),t("div",st,a(s.totalTimeSpent||0)+"h",1)]),t("div",at,[r[2]||(r[2]=t("img",{src:"/assets/account/dashboard-assets/stat-progress.webp",alt:"progress",class:"stat-card__icon"},null,-1)),t("div",et,a(s.t("account.dashboard.progress")),1),t("div",ot,a(s.progressPercentage||0)+"%",1)]),t("div",rt,[r[3]||(r[3]=t("img",{src:"/assets/account/dashboard-assets/stat-books.webp",alt:"books",class:"stat-card__icon"},null,-1)),t("div",ct,a(s.t("account.dashboard.storiesRead")),1),t("div",dt,a(s.storiesRead||0),1)])])]),s.recentStories.length>0?(n(),i("div",it,[t("h2",nt,a(s.t("account.dashboard.recentlyReading")),1),t("div",lt,[(n(!0),i(x,null,A(s.recentStories,e=>(n(),i("a",{key:e.key,href:s.toStory(e.key),class:"story-card"},[t("div",ht,[t("div",{class:"story-card__progress-bar",style:J({width:e.progress+"%"})},null,4)]),t("div",mt,[t("h3",ut,a(e.name),1),t("p",gt,a(e.timeSpent>0?e.timeSpent:0)+" min de "+a(e.totalTime>0?e.totalTime:0)+" min",1)])],8,_t))),128))])])):b("",!0),s.suggestedStories.length>0?(n(),i("div",bt,[t("h2",pt,a(s.t("account.dashboard.nextToRead")),1),t("div",St,[(n(!0),i(x,null,A(s.suggestedStories,e=>(n(),i("a",{key:e.key,href:s.toStory(e.key),class:"carousel-card"},[t("div",vt,[t("span",kt,a(s.t("account.dashboard.suggested")),1)]),t("div",yt,[t("h3",Tt,a(e.name),1),t("p",Mt,a(e.time?Math.ceil(parseInt(e.time)/60):0)+" "+a(s.t("account.dashboard.minutes")),1),e.saga?(n(),i("p",Nt,a(s.getSagaName(e.saga)),1)):b("",!0)]),t("div",xt,a(s.t("account.dashboard.start")),1)],8,ft))),128))])])):b("",!0)])}const Wt=j(L,[["render",At],["__scopeId","data-v-4d560138"]]);export{Wt as default};
