import{a as v}from"./index.CqFlbLC_.js";import{r as u,p as r}from"./runtime-core.esm-bundler.BLIdz6c-.js";const D=v();function I(s){const i=u([]),e=u({}),m=()=>s.story.split(`
`).filter(t=>t.trim()!=="")[0],p=()=>s.story.split(`
`).filter(t=>t.trim()!=="").map((t,a)=>`<p key=${a}>${t}</p>`).join("<br>"),f=()=>`${Math.ceil(parseInt(s.time)/60)} min`,g=()=>{if(s.saga)return D.find(t=>t.key===s.saga)?.name},l=()=>{i.value=JSON.parse(localStorage.getItem("storiesData"))||[],e.value=r(i).find(t=>t.key===s.key)},c=()=>{try{l();const t=r(e),a=Math.ceil(t.spentTime/parseInt(t.totalTime)*100),o=a>100?100:a;return{...t,current:o}}catch{return{}}},d=()=>c().current>=100,S=t=>{const a=e.value;a.like=t,e.value=a,n()},n=()=>{const t=JSON.parse(localStorage.getItem("storiesData"))||[],a=r(i).findIndex(o=>o.key===s.key);a===-1&&t.push({key:s.key,spentTime:0,totalTime:s.time,finished:!1,like:!1,startedAt:null,completedAt:null}),t[a]=r(e),localStorage.setItem("storiesData",JSON.stringify(t))},k=()=>{let t=e.value;t.spentTime+=10,t.spentTime>=parseInt(t.totalTime)&&(t.finished=!0,t.completedAt||(t.completedAt=Date.now())),e.value=t,n()};return{firstParagraph:m,getTime:f,html:p,getSaga:g,getCurrentStatus:c,setLikeStatus:S,isComplete:d,reading:()=>{l(),n(),e.value&&!e.value.startedAt&&(e.value.startedAt=Date.now(),n()),setInterval(k,1e4)}}}export{I as u};
